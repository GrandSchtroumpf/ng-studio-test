<ng-container *ngIf="node$ | async as directive">
  <app-sandbox (loaded)="loaded = $event" [name]="directive | nodeName"></app-sandbox>
  
  <ng-container *ngIf="loaded && (ast$ | async) as ast">
    <ng-container *ngFor="let node of ast.nodes; let i = index">
      <app-widget [node]="node" [selector]="node | selector: i"></app-widget>
    </ng-container>
  </ng-container>
</ng-container>